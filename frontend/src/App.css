/* =========================================
   1. VARIÁVEIS E RESET GLOBAL
   ========================================= */
:root {
  --bg-app: #09090b;       /* Fundo principal (quase preto) */
  --surface-dark: #18181b; /* Sidebar e Modais */
  --surface-light: #27272a; /* Inputs e Elementos secundários */
  --primary: #3b82f6;      /* Azul principal */
  --primary-hover: #2563eb;
  --success: #10b981;      /* Verde (Assinatura Válida) */
  --warning: #f59e0b;      /* Amarelo (Cifrado apenas) */
  --danger: #ef4444;       /* Vermelho (Assinatura Inválida) */
  --text-main: #f4f4f5;
  --text-muted: #a1a1aa;
  --border: #3f3f46;
  --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  --font-mono: 'JetBrains Mono', 'Consolas', monospace;
}

* { box-sizing: border-box; }

body, html {
  margin: 0; padding: 0;
  background-color: var(--bg-app);
  color: var(--text-main);
  font-family: var(--font-sans);
  height: 100vh;
  overflow: hidden; /* O scroll é gerenciado nos containers internos */
}

/* =========================================
   2. LAYOUT PRINCIPAL (Flexbox)
   ========================================= */
.app-container {
  display: flex;
  flex-direction: column;
  height: 100vh;
  width: 100vw;
}

/* --- HEADER --- */
.app-header {
  height: 70px;
  flex-shrink: 0; /* Garante altura fixa */
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 24px;
  background: rgba(9, 9, 11, 0.85);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid var(--border);
  z-index: 50;
}

.logo { display: flex; align-items: center; gap: 12px; }
.logo h1 { font-size: 18px; margin: 0; font-weight: 700; letter-spacing: -0.5px; }
.logo span { 
  font-size: 11px; font-weight: 600; 
  background: var(--surface-light); padding: 4px 8px; border-radius: 6px; color: var(--text-muted); 
}

.header-actions { display: flex; align-items: center; gap: 16px; }

/* Separador vertical no header */
.divider { width: 1px; height: 24px; background: var(--border); }

/* --- BOTÕES GERAIS --- */
.btn {
  border: none; padding: 0 16px; height: 36px; border-radius: 8px; cursor: pointer;
  font-size: 13px; font-weight: 600; display: flex; align-items: center; gap: 8px;
  transition: all 0.2s ease;
}
.btn-primary { background: var(--primary); color: white; box-shadow: 0 2px 8px rgba(59,130,246,0.25); }
.btn-primary:hover { background: var(--primary-hover); transform: translateY(-1px); }
.btn-outline { background: transparent; border: 1px solid var(--border); color: var(--text-main); }
.btn-outline:hover { border-color: var(--text-muted); background: var(--surface-light); }
.btn-ghost { background: transparent; color: var(--text-muted); }
.btn-ghost:hover { color: var(--text-main); background: var(--surface-light); }

/* --- ÁREA DE TRABALHO (WORKSPACE) --- */
.workspace {
  flex: 1; /* Ocupa todo o espaço restante */
  display: flex;
  overflow: hidden;
  position: relative;
}

/* =========================================
   3. SIMULADOR (Lado Esquerdo)
   ========================================= */
.simulator-area {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  background: radial-gradient(circle at center, #18181b 0%, #09090b 100%);
  padding: 40px;
  gap: 40px; /* Distância entre celulares */
  overflow-y: auto; /* Scroll se a tela for pequena */
}

/* Wrapper do Celular + Chaves */
.device-wrapper {
  display: flex; flex-direction: column; align-items: center;
  gap: 20px; width: 320px; position: relative; z-index: 10;
}

/* CELULAR */
.phone-case {
  width: 100%; height: 600px;
  background: #000;
  border-radius: 48px;
  border: 6px solid #27272a;
  box-shadow: 0 25px 50px -12px rgba(0,0,0,0.7);
  position: relative; overflow: hidden;
  display: flex; flex-direction: column;
}

.notch {
  width: 120px; height: 24px; background: #27272a;
  position: absolute; top: 0; left: 50%; transform: translateX(-50%);
  border-bottom-left-radius: 16px; border-bottom-right-radius: 16px; z-index: 20;
}

.screen-content {
  flex: 1; background: var(--surface-dark);
  display: flex; flex-direction: column;
  border-radius: 40px; overflow: hidden;
}

/* Chat Header (Dentro do celular) */
.chat-header {
  padding: 45px 20px 15px;
  background: rgba(39, 39, 42, 0.9); backdrop-filter: blur(8px);
  border-bottom: 1px solid rgba(255,255,255,0.05);
  display: flex; align-items: center; gap: 12px;
}
.avatar {
  width: 36px; height: 36px; border-radius: 50%;
  color: white; display: flex; align-items: center; justify-content: center;
  font-weight: bold; font-size: 14px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}
.user-info h3 { margin: 0; font-size: 14px; font-weight: 600; }
.user-info p { margin: 0; font-size: 10px; color: var(--success); font-weight: 500; }

/* Lista de Mensagens */
.messages-list {
  flex: 1; padding: 15px; overflow-y: auto;
  display: flex; flex-direction: column; gap: 12px;
}

/* Balões de Mensagem */
.bubble {
  max-width: 85%; padding: 10px 14px; border-radius: 18px;
  font-size: 13px; line-height: 1.4; position: relative; word-wrap: break-word;
  box-shadow: 0 1px 2px rgba(0,0,0,0.1);
}
.bubble.me { align-self: flex-end; background: var(--primary); color: white; border-bottom-right-radius: 4px; }
.bubble.other { align-self: flex-start; background: var(--surface-light); color: var(--text-main); border-bottom-left-radius: 4px; }

/* Mensagem Bloqueada/Cifrada */
.locked-content { display: flex; align-items: center; gap: 10px; cursor: pointer; opacity: 0.9; }
.locked-content:hover { opacity: 1; }
.lock-icon { background: rgba(255,255,255,0.1); padding: 8px; border-radius: 50%; display: flex; }
.hex-preview { font-family: var(--font-mono); font-size: 10px; opacity: 0.8; color: var(--warning); margin-bottom: 2px; }
.unlock-hint { font-size: 9px; display: block; opacity: 0.6; }
.signature-hint { font-size: 9px; color: var(--success); display: flex; align-items: center; gap: 4px; font-weight: 600; }

/* Selos de Segurança (Novo!) */
.security-badge {
  margin-top: 8px; padding-top: 6px; border-top: 1px solid rgba(255,255,255,0.15);
  font-size: 9px; font-weight: 700; display: flex; align-items: center; gap: 5px;
}
.security-badge.valid { color: #86efac; /* Verde claro */ }
.security-badge.invalid { color: #fca5a5; /* Vermelho claro */ }
.security-badge.warning { color: #fde047; /* Amarelo claro */ }

/* Controles (Toggle + Input) no Celular */
.controls-area {
  background: #202023; padding: 10px;
  display: flex; align-items: center; gap: 8px;
  border-top: 1px solid rgba(255,255,255,0.05);
}

.signature-toggle {
  width: 36px; height: 36px; border-radius: 8px;
  background: var(--surface-light);
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; transition: all 0.2s; border: 1px solid transparent;
}
.signature-toggle:hover { background: #333; }
.signature-toggle.active { background: rgba(16, 185, 129, 0.15); border-color: var(--success); }

/* Input de Texto */
.input-area {
  flex: 1; display: flex; align-items: center; gap: 8px;
  background: var(--surface-light); padding: 4px 6px 4px 12px;
  border-radius: 20px; border: 1px solid rgba(255,255,255,0.05);
}
.input-area input {
  flex: 1; background: transparent; border: none;
  color: white; font-size: 13px; outline: none; padding: 8px 0;
}

/* Botão de Enviar (CORRIGIDO) */
.send-btn {
  width: 32px; height: 32px; border-radius: 50%;
  background: var(--primary); border: none; padding: 0;
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; flex-shrink: 0;
  transition: transform 0.2s;
}
.send-btn:hover { transform: scale(1.1); background: var(--primary-hover); }
.send-btn:disabled { background: var(--surface-light); cursor: not-allowed; opacity: 0.5; transform: none; }
.send-btn svg { width: 18px; height: 18px; fill: white; display: block; }

/* Cartões de Chave (Abaixo do celular) */
.key-card {
  width: 100%; background: rgba(24, 24, 27, 0.7);
  border: 1px solid var(--border); border-radius: 12px;
  padding: 12px; backdrop-filter: blur(10px);
}
.key-header { 
  display: flex; justify-content: space-between; align-items: center;
  font-size: 10px; font-weight: 700; color: var(--text-muted); 
  text-transform: uppercase; margin-bottom: 8px;
}
.key-row {
  display: flex; justify-content: space-between;
  font-size: 11px; font-family: var(--font-mono); color: var(--text-muted);
  border-bottom: 1px solid rgba(255,255,255,0.05); padding: 4px 0;
}
.key-row span:last-child { color: var(--success); }

/* =========================================
   4. LOGS (Lado Direito)
   ========================================= */
.sidebar {
  width: 320px; min-width: 300px;
  background: var(--surface-dark);
  border-left: 1px solid var(--border);
  display: flex; flex-direction: column;
}

.sidebar-header {
  padding: 16px 20px; font-size: 11px; font-weight: 700;
  color: var(--text-muted); border-bottom: 1px solid var(--border);
  text-transform: uppercase; letter-spacing: 1px;
  display: flex; align-items: center;
}

.log-stream {
  flex: 1; overflow-y: auto; padding: 20px;
  font-family: var(--font-mono); font-size: 11px;
  display: flex; flex-direction: column; gap: 10px;
}

.log-item { display: flex; gap: 12px; line-height: 1.5; opacity: 0; animation: fadeUp 0.3s forwards; }
@keyframes fadeUp { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

.log-time { color: #52525b; min-width: 50px; text-align: right; }
.log-msg { color: #d4d4d8; }
.log-msg.math { color: var(--warning); }
.log-msg.secure { color: var(--success); }
.log-msg.system { color: var(--primary); }
.log-msg.error { color: var(--danger); }

/* =========================================
   5. COMPONENTES: TOGGLES E MODAIS
   ========================================= */

/* Toggle Switch no Header */
.toggle-container {
  display: flex; align-items: center; gap: 12px;
  padding: 6px 8px 6px 16px; border-radius: 99px;
  background: var(--surface-light); border: 1px solid var(--border);
  cursor: pointer; transition: all 0.3s;
}
.toggle-container:hover { border-color: var(--text-muted); }
.toggle-container.active { background: rgba(16, 185, 129, 0.1); border-color: var(--success); }

.toggle-label { display: flex; flex-direction: column; align-items: flex-end; line-height: 1.1; }
.toggle-title { font-size: 11px; font-weight: 700; color: var(--text-main); }
.toggle-status { font-size: 9px; color: var(--text-muted); letter-spacing: 0.5px; }
.toggle-container.active .toggle-status { color: var(--success); font-weight: 700; }

.toggle-switch {
  width: 40px; height: 22px;
  background: #3f3f46; border-radius: 99px;
  position: relative; transition: background 0.3s;
}
.toggle-container.active .toggle-switch { background: var(--success); }

.toggle-knob {
  width: 18px; height: 18px;
  background: white; border-radius: 50%;
  position: absolute; top: 2px; left: 2px;
  display: flex; align-items: center; justify-content: center;
  transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  box-shadow: 0 1px 3px rgba(0,0,0,0.3);
}
.toggle-knob svg { width: 10px; height: 10px; color: #333; }
.toggle-container.active .toggle-knob { transform: translateX(18px); }

/* --- MODAIS (Tutorial e Educação) --- */
.tutorial-overlay {
  position: fixed; inset: 0; background: rgba(0, 0, 0, 0.85);
  display: flex; align-items: center; justify-content: center;
  z-index: 9999; backdrop-filter: blur(5px);
}

.tutorial-card, .education-card {
  background: #18181b;
  border: 1px solid var(--border);
  border-radius: 24px; padding: 40px;
  max-width: 500px; width: 90%;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.9);
  text-align: center;
}

.tut-icon {
  width: 64px; height: 64px; margin: 0 auto 20px;
  background: rgba(59, 130, 246, 0.1); color: var(--primary);
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
}

.tut-title { font-size: 20px; font-weight: 700; color: white; margin-bottom: 12px; }
.tut-desc { color: var(--text-muted); font-size: 14px; line-height: 1.6; margin-bottom: 30px; }

.tut-steps { display: flex; justify-content: center; gap: 8px; margin-bottom: 30px; }
.dot { width: 8px; height: 8px; background: var(--surface-light); border-radius: 50%; transition: all 0.3s; }
.dot.active { background: var(--primary); transform: scale(1.2); }

/* Modal de Educação da Assinatura */
.edu-header { display: flex; flex-direction: column; align-items: center; margin-bottom: 20px; }
.text-accent { color: var(--success); margin-bottom: 10px; }
.edu-header h2 { font-size: 22px; margin: 0; }

.edu-intro { color: var(--text-muted); font-size: 13px; line-height: 1.5; margin-bottom: 25px; }

.edu-grid { display: flex; flex-direction: column; gap: 15px; margin-bottom: 30px; }
.edu-item {
  display: flex; align-items: flex-start; gap: 15px;
  background: var(--surface-light); padding: 12px; border-radius: 12px;
  text-align: left;
}
.edu-icon {
  background: rgba(255,255,255,0.05); padding: 8px; border-radius: 8px; color: var(--primary);
}
.edu-item strong { display: block; font-size: 13px; color: white; margin-bottom: 2px; }
.edu-item p { margin: 0; font-size: 11px; color: var(--text-muted); line-height: 1.3; }

.full-width { width: 100%; justify-content: center; height: 44px; }

.toast-notification {
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(30, 30, 30, 0.9);
  backdrop-filter: blur(10px);
  padding: 12px 20px;
  border-radius: 50px;
  border: 1px solid var(--border);
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  display: flex;
  align-items: center;
  gap: 12px;
  z-index: 9999;
  font-size: 13px;
  color: white;
}

.toast-notification.error { border-color: var(--danger); }
.toast-notification.error svg { color: var(--danger); }

.toast-notification.info { border-color: var(--success); }
.toast-notification.info svg { color: var(--success); }

.toast-notification button {
  background: none; border: none; color: #888; cursor: pointer; padding: 0; margin-left: 10px;
}

/* Ajuste na Sidebar para mostrar chaves no rodapé */
.sidebar-footer {
  padding: 15px;
  background: var(--surface-light);
  border-top: 1px solid var(--border);
  font-size: 10px;
  color: var(--text-muted);
  display: flex;
  justify-content: space-between;
}
.mini-key { font-family: monospace; }

/* Botão de Enviar Bloqueado Visualmente */
/* --- BARRA DE INPUT COMPACTA --- */
.input-area {
  min-height: 60px; /* Altura fixa elegante */
  max-height: 60px;
  padding: 0 12px; /* Apenas laterais, altura definida pelo flex */
  background: #202023;
  display: flex;
  align-items: center;
  gap: 10px;
  border-top: 1px solid rgba(255,255,255,0.05);
  flex-shrink: 0; /* Impede que estique ou encolha */
}

.input-area input {
  flex: 1;
  height: 36px; /* Altura controlada do campo de texto */
  background: #151515;
  border: 1px solid #333;
  border-radius: 18px;
  padding: 0 15px; /* Texto centralizado verticalmente */
  color: white;
  font-size: 13px;
  outline: none;
  transition: border-color 0.2s;
}

.input-area input:focus {
  border-color: var(--primary);
}

.input-area input:disabled {
  background: #2a2a2a;
  color: #666;
  border-color: transparent;
}

/* Botão de Enviar (Ajustado para caber na barra) */
.send-btn {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: var(--primary);
  border: none;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  flex-shrink: 0;
  transition: transform 0.2s, background-color 0.2s;
}

.send-btn:hover {
  transform: scale(1.05);
  background: var(--primary-hover);
}

.send-btn:disabled {
  opacity: 0.5;
  background: #444;
  cursor: not-allowed;
  transform: none;
}

.send-btn svg {
  width: 18px;
  height: 18px;
  fill: white;
  display: block;
}

.hacker-btn {
  background: #333;
  /* Largura automática para caber o texto */
  height: 36px;
  padding: 0 12px;
  border-radius: 20px; /* Formato Pílula */
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px; /* Espaço entre ícone e texto */
  cursor: pointer;
  color: #888;
  border: 1px solid #444;
  transition: all 0.3s ease;
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.hacker-btn:hover {
  background: #444;
  color: #ff453a;
  border-color: #ff453a;
}

.hacker-btn.active {
  background: #ff453a;
  color: white;
  border-color: #ff453a;
  box-shadow: 0 0 15px rgba(255, 69, 58, 0.4);
  animation: pulse 1.5s infinite;
}

/* Opcional: esconde o texto em telas muito pequenas se necessário */
.hacker-label {
  display: block;
}

@keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

/* Responsividade Básica */
@media (max-width: 1024px) {
  .workspace { flex-direction: column; overflow-y: auto; }
  .simulator-area { flex-direction: column; gap: 30px; padding: 20px; }
  .sidebar { width: 100%; height: 300px; border-left: none; border-top: 1px solid var(--border); }
  .device-wrapper { width: 100%; max-width: 320px; }
}